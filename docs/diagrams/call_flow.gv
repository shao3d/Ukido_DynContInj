digraph G {
concentrate=true;
splines="ortho";
rankdir="LR";
node_6ac2151c [label="0: (global)()" name="config::(global)" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_50d592aa [label="0: (global)()" name="gemini_cached_client::(global)" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_5e1dd9a2 [label="15: __init__()" name="gemini_cached_client::GeminiCachedClient.__init__" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_07550912 [label="21: _compute_context_hash()" name="gemini_cached_client::GeminiCachedClient._compute_context_hash" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_2a36157a [label="25: chat_with_cache()" name="gemini_cached_client::GeminiCachedClient.chat_with_cache" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_470e78aa [label="76: chat_with_prefix_cache()" name="gemini_cached_client::GeminiCachedClient.chat_with_prefix_cache" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_87cdaffd [label="0: (global)()" name="history_manager::(global)" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_cffb7c84 [label="12: __init__()" name="history_manager::HistoryManager.__init__" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_e6c1fa55 [label="18: add_message()" name="history_manager::HistoryManager.add_message" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_916de57a [label="34: get_history()" name="history_manager::HistoryManager.get_history" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_645bd1a5 [label="0: (global)()" name="main::(global)" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_8af7cc5a [label="65: chat()" name="main::chat" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_cc22258b [label="176: health_check()" name="main::health_check" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_73b6b308 [label="182: root()" name="main::root" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_7a3eeab1 [label="0: (global)()" name="openrouter_client::(global)" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_359018dd [label="12: __init__()" name="openrouter_client::OpenRouterClient.__init__" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_c24aaa1d [label="21: chat()" name="openrouter_client::OpenRouterClient.chat" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_1d3cdda6 [label="0: (global)()" name="response_generator::(global)" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_3cffc6fd [label="17: __init__()" name="response_generator::ResponseGenerator.__init__" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_675e49a5 [label="90: _build_messages()" name="response_generator::ResponseGenerator._build_messages" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_d2b02059 [label="272: _final_sanitize()" name="response_generator::ResponseGenerator._final_sanitize" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_e43f1ab3 [label="224: _humanize_missing_info()" name="response_generator::ResponseGenerator._humanize_missing_info" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_bdfdac55 [label="68: _load_docs()" name="response_generator::ResponseGenerator._load_docs" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_54d21248 [label="199: _remove_question_headings()" name="response_generator::ResponseGenerator._remove_question_headings" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_626bc30a [label="306: _sanitize_style()" name="response_generator::ResponseGenerator._sanitize_style" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_25ab636e [label="255: _strip_generic_cta()" name="response_generator::ResponseGenerator._strip_generic_cta" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_0d224160 [label="239: _strip_service_labels()" name="response_generator::ResponseGenerator._strip_service_labels" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_91f4a8fb [label="193: _strip_source_citations()" name="response_generator::ResponseGenerator._strip_source_citations" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_d84bed23 [label="30: generate()" name="response_generator::ResponseGenerator.generate" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_f22662c3 [label="0: (global)()" name="router::(global)" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_b8f307a9 [label="21: __init__()" name="router::Router.__init__" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_3415c8b0 [label="362: _build_router_prompts()" name="router::Router._build_router_prompts" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_daf06e27 [label="657: _fallback_response()" name="router::Router._fallback_response" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_a1efbb00 [label="578: _get_classification_section()" name="router::Router._get_classification_section" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_e27cd526 [label="440: _get_decomposition_section()" name="router::Router._get_decomposition_section" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_ab34b64f [label="407: _get_history_section()" name="router::Router._get_history_section" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_3457066e [label="645: _get_response_format_section()" name="router::Router._get_response_format_section" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_fb8d67a9 [label="383: _get_role_section()" name="router::Router._get_role_section" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_22071042 [label="400: _get_summaries_section()" name="router::Router._get_summaries_section" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_118923f1 [label="56: _is_recent_session()" name="router::Router._is_recent_session" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_0c92b1bc [label="73: _load_summaries()" name="router::Router._load_summaries" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_0315ce7d [label="93: route()" name="router::Router.route" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_8c2b5394 [label="0: (global)()" name="social_intents::(global)" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_712fb0b7 [label="177: detect_social_intent()" name="social_intents::detect_social_intent" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_ac772a84 [label="208: fuzzy_match_word()" name="social_intents::fuzzy_match_word" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_535ca79c [label="231: has_business_signals()" name="social_intents::has_business_signals" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_3238bd8a [label="259: has_business_signals_extended()" name="social_intents::has_business_signals_extended" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_fb84396f [label="0: (global)()" name="social_responder::(global)" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_36eb72aa [label="18: __init__()" name="social_responder::SocialResponder.__init__" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_14281e65 [label="21: make_prefix()" name="social_responder::SocialResponder.make_prefix" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_319a3138 [label="49: respond()" name="social_responder::SocialResponder.respond" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_442274da [label="12: _tod_greeting()" name="social_responder::_tod_greeting" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_ba4c002b [label="0: (global)()" name="social_state::(global)" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_9aea52d9 [label="19: __init__()" name="social_state::SocialStateManager.__init__" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_07aedbb5 [label="27: _ensure()" name="social_state::SocialStateManager._ensure" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_dfd13f5f [label="24: _now()" name="social_state::SocialStateManager._now" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_d992e1b5 [label="35: get()" name="social_state::SocialStateManager.get" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_7b29662a [label="38: has_greeted()" name="social_state::SocialStateManager.has_greeted" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_087ef5c6 [label="52: mark_farewell()" name="social_state::SocialStateManager.mark_farewell" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_b9799af0 [label="43: mark_greeted()" name="social_state::SocialStateManager.mark_greeted" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_ad175f1b [label="47: mark_greeting()" name="social_state::SocialStateManager.mark_greeting" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_4f3a09b9 [label="57: reset_farewell()" name="social_state::SocialStateManager.reset_farewell" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_29275184 [label="0: (global)()" name="standard_responses::(global)" shape="rect" style="rounded,filled" fillcolor="#966F33" ];
node_0b2410be [label="35: get_error_response()" name="standard_responses::get_error_response" shape="rect" style="rounded,filled" fillcolor="#cccccc" ];
node_f0ba0ac1 [label="31: get_offtopic_response()" name="standard_responses::get_offtopic_response" shape="rect" style="rounded,filled" fillcolor="#6db33f" ];
node_2a36157a -> node_07550912 [color="#56B4E9" penwidth="2"];
node_2a36157a -> node_c24aaa1d [color="#56B4E9" penwidth="2"];
node_470e78aa -> node_c24aaa1d [color="#56B4E9" penwidth="2"];
node_916de57a -> node_d992e1b5 [color="#56B4E9" penwidth="2"];
node_645bd1a5 -> node_cffb7c84 [color="#0072B2" penwidth="2"];
node_645bd1a5 -> node_3cffc6fd [color="#0072B2" penwidth="2"];
node_645bd1a5 -> node_b8f307a9 [color="#0072B2" penwidth="2"];
node_645bd1a5 -> node_36eb72aa [color="#0072B2" penwidth="2"];
node_645bd1a5 -> node_9aea52d9 [color="#0072B2" penwidth="2"];
node_8af7cc5a -> node_e6c1fa55 [color="#56B4E9" penwidth="2"];
node_8af7cc5a -> node_e6c1fa55 [color="#56B4E9" penwidth="2"];
node_8af7cc5a -> node_916de57a [color="#56B4E9" penwidth="2"];
node_8af7cc5a -> node_d84bed23 [color="#56B4E9" penwidth="2"];
node_8af7cc5a -> node_0315ce7d [color="#56B4E9" penwidth="2"];
node_8af7cc5a -> node_d992e1b5 [color="#56B4E9" penwidth="2"];
node_8af7cc5a -> node_d992e1b5 [color="#56B4E9" penwidth="2"];
node_8af7cc5a -> node_d992e1b5 [color="#56B4E9" penwidth="2"];
node_8af7cc5a -> node_d992e1b5 [color="#56B4E9" penwidth="2"];
node_8af7cc5a -> node_d992e1b5 [color="#56B4E9" penwidth="2"];
node_8af7cc5a -> node_d992e1b5 [color="#56B4E9" penwidth="2"];
node_8af7cc5a -> node_7b29662a [color="#56B4E9" penwidth="2"];
node_8af7cc5a -> node_b9799af0 [color="#56B4E9" penwidth="2"];
node_8af7cc5a -> node_0b2410be [color="#56B4E9" penwidth="2"];
node_c24aaa1d -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_3cffc6fd -> node_359018dd [color="#0072B2" penwidth="2"];
node_675e49a5 -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_675e49a5 -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_626bc30a -> node_d2b02059 [color="#56B4E9" penwidth="2"];
node_d84bed23 -> node_675e49a5 [color="#009E73" penwidth="2"];
node_d84bed23 -> node_d2b02059 [color="#009E73" penwidth="2"];
node_d84bed23 -> node_e43f1ab3 [color="#009E73" penwidth="2"];
node_d84bed23 -> node_bdfdac55 [color="#009E73" penwidth="2"];
node_d84bed23 -> node_54d21248 [color="#009E73" penwidth="2"];
node_d84bed23 -> node_25ab636e [color="#009E73" penwidth="2"];
node_d84bed23 -> node_0d224160 [color="#009E73" penwidth="2"];
node_d84bed23 -> node_91f4a8fb [color="#009E73" penwidth="2"];
node_d84bed23 -> node_d992e1b5 [color="#009E73" penwidth="2"];
node_d84bed23 -> node_d992e1b5 [color="#009E73" penwidth="2"];
node_d84bed23 -> node_d992e1b5 [color="#009E73" penwidth="2"];
node_b8f307a9 -> node_5e1dd9a2 [color="#E69F00" penwidth="2"];
node_b8f307a9 -> node_359018dd [color="#E69F00" penwidth="2"];
node_b8f307a9 -> node_0c92b1bc [color="#E69F00" penwidth="2"];
node_b8f307a9 -> node_36eb72aa [color="#E69F00" penwidth="2"];
node_b8f307a9 -> node_9aea52d9 [color="#E69F00" penwidth="2"];
node_3415c8b0 -> node_a1efbb00 [color="#000000" penwidth="2"];
node_3415c8b0 -> node_e27cd526 [color="#000000" penwidth="2"];
node_3415c8b0 -> node_ab34b64f [color="#000000" penwidth="2"];
node_3415c8b0 -> node_3457066e [color="#000000" penwidth="2"];
node_3415c8b0 -> node_fb8d67a9 [color="#000000" penwidth="2"];
node_3415c8b0 -> node_22071042 [color="#000000" penwidth="2"];
node_ab34b64f -> node_d992e1b5 [color="#CC79A7" penwidth="2"];
node_ab34b64f -> node_d992e1b5 [color="#CC79A7" penwidth="2"];
node_0315ce7d -> node_2a36157a [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_2a36157a [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_3415c8b0 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_3415c8b0 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_daf06e27 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_daf06e27 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_daf06e27 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_118923f1 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_712fb0b7 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_3238bd8a [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_319a3138 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_7b29662a [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_7b29662a [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_b9799af0 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_b9799af0 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_b9799af0 [color="#0072B2" penwidth="2"];
node_0315ce7d -> node_f0ba0ac1 [color="#0072B2" penwidth="2"];
node_712fb0b7 -> node_535ca79c [color="#CC79A7" penwidth="2"];
node_535ca79c -> node_ac772a84 [color="#F0E442" penwidth="2"];
node_3238bd8a -> node_ac772a84 [color="#56B4E9" penwidth="2"];
node_14281e65 -> node_442274da [color="#0072B2" penwidth="2"];
node_14281e65 -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_14281e65 -> node_ad175f1b [color="#0072B2" penwidth="2"];
node_319a3138 -> node_442274da [color="#000000" penwidth="2"];
node_319a3138 -> node_d992e1b5 [color="#000000" penwidth="2"];
node_319a3138 -> node_087ef5c6 [color="#000000" penwidth="2"];
node_319a3138 -> node_ad175f1b [color="#000000" penwidth="2"];
node_07aedbb5 -> node_dfd13f5f [color="#0072B2" penwidth="2"];
node_07aedbb5 -> node_d992e1b5 [color="#0072B2" penwidth="2"];
node_d992e1b5 -> node_07aedbb5 [color="#0072B2" penwidth="2"];
node_7b29662a -> node_07aedbb5 [color="#56B4E9" penwidth="2"];
node_087ef5c6 -> node_07aedbb5 [color="#D55E00" penwidth="2"];
node_087ef5c6 -> node_dfd13f5f [color="#D55E00" penwidth="2"];
node_b9799af0 -> node_ad175f1b [color="#000000" penwidth="2"];
node_ad175f1b -> node_07aedbb5 [color="#009E73" penwidth="2"];
node_ad175f1b -> node_dfd13f5f [color="#009E73" penwidth="2"];
node_4f3a09b9 -> node_07aedbb5 [color="#E69F00" penwidth="2"];
node_0b2410be -> node_d992e1b5 [color="#D55E00" penwidth="2"];
subgraph cluster_1200306a {
    node_6ac2151c;
    label="File: config";
    name="config";
    style="filled";
    graph[style=dotted];
    subgraph cluster_657c6d16 {
        label="Class: Config";
        name="Config";
        style="filled";
        graph[style=dotted];
    };
};
subgraph cluster_93ea7140 {
    node_50d592aa;
    label="File: gemini_cached_client";
    name="gemini_cached_client";
    style="filled";
    graph[style=dotted];
    subgraph cluster_42bbf4b3 {
        node_5e1dd9a2 node_07550912 node_2a36157a node_470e78aa;
        label="Class: GeminiCachedClient";
        name="GeminiCachedClient";
        style="filled";
        graph[style=dotted];
    };
};
subgraph cluster_10faac41 {
    node_87cdaffd;
    label="File: history_manager";
    name="history_manager";
    style="filled";
    graph[style=dotted];
    subgraph cluster_d5a8fcce {
        node_cffb7c84 node_e6c1fa55 node_916de57a;
        label="Class: HistoryManager";
        name="HistoryManager";
        style="filled";
        graph[style=dotted];
    };
};
subgraph cluster_a6058a77 {
    node_8af7cc5a node_cc22258b node_73b6b308 node_645bd1a5;
    label="File: main";
    name="main";
    style="filled";
    graph[style=dotted];
    subgraph cluster_50bff1ad {
        label="Class: ChatRequest";
        name="ChatRequest";
        style="filled";
        graph[style=dotted];
    };
    subgraph cluster_afe5f724 {
        label="Class: ChatResponse";
        name="ChatResponse";
        style="filled";
        graph[style=dotted];
    };
};
subgraph cluster_8ba87db3 {
    node_7a3eeab1;
    label="File: openrouter_client";
    name="openrouter_client";
    style="filled";
    graph[style=dotted];
    subgraph cluster_b97e6b9a {
        node_359018dd node_c24aaa1d;
        label="Class: OpenRouterClient";
        name="OpenRouterClient";
        style="filled";
        graph[style=dotted];
    };
};
subgraph cluster_7510f637 {
    node_1d3cdda6;
    label="File: response_generator";
    name="response_generator";
    style="filled";
    graph[style=dotted];
    subgraph cluster_3d5769ae {
        node_3cffc6fd node_d84bed23 node_bdfdac55 node_675e49a5 node_91f4a8fb node_54d21248 node_e43f1ab3 node_0d224160 node_25ab636e node_d2b02059 node_626bc30a;
        label="Class: ResponseGenerator";
        name="ResponseGenerator";
        style="filled";
        graph[style=dotted];
    };
};
subgraph cluster_d9f589e0 {
    node_f22662c3;
    label="File: router";
    name="router";
    style="filled";
    graph[style=dotted];
    subgraph cluster_a0340bd5 {
        node_b8f307a9 node_118923f1 node_0c92b1bc node_0315ce7d node_3415c8b0 node_fb8d67a9 node_22071042 node_ab34b64f node_e27cd526 node_a1efbb00 node_3457066e node_daf06e27;
        label="Class: Router";
        name="Router";
        style="filled";
        graph[style=dotted];
    };
};
subgraph cluster_6d62b0b2 {
    node_712fb0b7 node_ac772a84 node_535ca79c node_3238bd8a node_8c2b5394;
    label="File: social_intents";
    name="social_intents";
    style="filled";
    graph[style=dotted];
    subgraph cluster_2c93f5c6 {
        label="Class: SocialIntent";
        name="SocialIntent";
        style="filled";
        graph[style=dotted];
    };
    subgraph cluster_30942184 {
        label="Class: SocialDetection";
        name="SocialDetection";
        style="filled";
        graph[style=dotted];
    };
};
subgraph cluster_acea20b7 {
    node_442274da node_fb84396f;
    label="File: social_responder";
    name="social_responder";
    style="filled";
    graph[style=dotted];
    subgraph cluster_d67d0c27 {
        node_36eb72aa node_14281e65 node_319a3138;
        label="Class: SocialResponder";
        name="SocialResponder";
        style="filled";
        graph[style=dotted];
    };
};
subgraph cluster_0be4965b {
    node_ba4c002b;
    label="File: social_state";
    name="social_state";
    style="filled";
    graph[style=dotted];
    subgraph cluster_7d06d819 {
        label="Class: SessionSocialState";
        name="SessionSocialState";
        style="filled";
        graph[style=dotted];
    };
    subgraph cluster_e0d5185e {
        node_9aea52d9 node_dfd13f5f node_07aedbb5 node_d992e1b5 node_7b29662a node_b9799af0 node_ad175f1b node_087ef5c6 node_4f3a09b9;
        label="Class: SocialStateManager";
        name="SocialStateManager";
        style="filled";
        graph[style=dotted];
    };
};
subgraph cluster_04c323b2 {
    node_f0ba0ac1 node_0b2410be node_29275184;
    label="File: standard_responses";
    name="standard_responses";
    style="filled";
    graph[style=dotted];
};
}
