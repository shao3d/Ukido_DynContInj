# –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∫—É—Ä—Å–æ–≤ - MVP

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 30.08.2025  
**–í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã:** 0.12.18  
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–∏—Å—Ç–µ–º–∞ –ø—É—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É –∫—É—Ä—Å–∞–º–∏ (–ø—Ä–∏–º–µ—Ä: –æ—Ç–≤–µ—Ç–∏–ª–∞ "8 —á–µ–ª–æ–≤–µ–∫" –≤–º–µ—Å—Ç–æ "6" –¥–ª—è –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ö–æ–º–ø–∞—Å–∞)
**–¶–µ–ª—å:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—É—Ç–∞–Ω–∏—Ü—É –ø—Ä–∏ –æ—Ç–≤–µ—Ç–∞—Ö –æ —Ä–∞–∑–Ω—ã—Ö –∫—É—Ä—Å–∞—Ö

## üìã –†–µ–∑—é–º–µ –∑–∞–¥–∞—á–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–∏—Å—Ç–µ–º–∞ –ø—É—Ç–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –º–µ–∂–¥—É –∫—É—Ä—Å–∞–º–∏ (–ø—Ä–∏–º–µ—Ä: "8 —á–µ–ª–æ–≤–µ–∫" –≤–º–µ—Å—Ç–æ "6" –¥–ª—è –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ö–æ–º–ø–∞—Å–∞)

**–†–µ—à–µ–Ω–∏–µ:** 
1. –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä –≥—Ä—É–ø–ø ‚Üí 6 –¥–µ—Ç–µ–π –¥–ª—è –≤—Å–µ—Ö –∫—É—Ä—Å–æ–≤
2. –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –∫—É—Ä—Å –≤ –∫–∞–∂–¥–æ–º –æ—Ç–≤–µ—Ç–µ
3. –ü—Ä–∏ –Ω–µ—è—Å–Ω–æ—Å—Ç–∏ –¥–∞–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –≤—Å–µ–º –∫—É—Ä—Å–∞–º
4. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –≤–µ–∂–ª–∏–≤—ã–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –∫—Ä–∏—Ç–∏—á–Ω–æ

## üéØ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### 1. –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –≥—Ä—É–ø–ø –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `/data/documents_compressed/courses_detailed.md`
- `/data/documents_compressed/faq.md`
- `/data/documents_compressed/safety_and_trust.md`

**–ß—Ç–æ –º–µ–Ω—è—Ç—å:**
```
–°—Ç–∞—Ä–æ–µ:
- "–Æ–Ω—ã–π –û—Ä–∞—Ç–æ—Ä": –¥–æ 8 –¥–µ—Ç–µ–π ‚Üí –¥–æ 6 –¥–µ—Ç–µ–π
- "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ö–æ–º–ø–∞—Å": –¥–æ 6 –¥–µ—Ç–µ–π (–æ—Å—Ç–∞–≤–∏—Ç—å)
- "–ö–∞–ø–∏—Ç–∞–Ω –ü—Ä–æ–µ–∫—Ç–æ–≤": –∫–æ–º–∞–Ω–¥—ã 4-5 —á–µ–ª–æ–≤–µ–∫ ‚Üí –¥–æ 6 –¥–µ—Ç–µ–π

–ù–æ–≤–æ–µ –¥–ª—è –í–°–ï–• –∫—É—Ä—Å–æ–≤:
"–ì—Ä—É–ø–ø—ã –¥–æ 6 –¥–µ—Ç–µ–π"
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫—É—Ä—Å–∞ –≤ Router

**–§–∞–π–ª:** `src/router.py`

**–ì–¥–µ –¥–æ–±–∞–≤–∏—Ç—å:** –ü–æ—Å–ª–µ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ (—Å—Ç—Ä–æ–∫–∞ ~270), –ø–µ—Ä–µ–¥ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π

**–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å:**
```python
# === –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –ö–û–ù–¢–ï–ö–°–¢–ê –ö–£–†–°–ê (MVP) ===
# –ü—Ä–æ—Å—Ç–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏
detected_course = None
detected_age = None

# –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤–æ–∑—Ä–∞—Å—Ç–∞
age_patterns = {
    "7": "–Æ–Ω—ã–π –û—Ä–∞—Ç–æ—Ä",
    "8": "–Æ–Ω—ã–π –û—Ä–∞—Ç–æ—Ä", 
    "—Å–µ–º—å": "–Æ–Ω—ã–π –û—Ä–∞—Ç–æ—Ä",
    "–≤–æ—Å–µ–º—å": "–Æ–Ω—ã–π –û—Ä–∞—Ç–æ—Ä",
    "7-": "–Æ–Ω—ã–π –û—Ä–∞—Ç–æ—Ä",
    "8-": "–Æ–Ω—ã–π –û—Ä–∞—Ç–æ—Ä",
    
    "9": "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ö–æ–º–ø–∞—Å",
    "10": "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ö–æ–º–ø–∞—Å",
    "–¥–µ–≤—è—Ç—å": "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ö–æ–º–ø–∞—Å",
    "–¥–µ—Å—è—Ç—å": "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ö–æ–º–ø–∞—Å",
    "9-": "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ö–æ–º–ø–∞—Å",
    "10-": "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ö–æ–º–ø–∞—Å",
    
    "11": "–ö–∞–ø–∏—Ç–∞–Ω –ü—Ä–æ–µ–∫—Ç–æ–≤",
    "12": "–ö–∞–ø–∏—Ç–∞–Ω –ü—Ä–æ–µ–∫—Ç–æ–≤",
    "13": "–ö–∞–ø–∏—Ç–∞–Ω –ü—Ä–æ–µ–∫—Ç–æ–≤",
    "14": "–ö–∞–ø–∏—Ç–∞–Ω –ü—Ä–æ–µ–∫—Ç–æ–≤",
    "–æ–¥–∏–Ω–Ω–∞–¥—Ü–∞—Ç—å": "–ö–∞–ø–∏—Ç–∞–Ω –ü—Ä–æ–µ–∫—Ç–æ–≤",
    "–¥–≤–µ–Ω–∞–¥—Ü–∞—Ç—å": "–ö–∞–ø–∏—Ç–∞–Ω –ü—Ä–æ–µ–∫—Ç–æ–≤",
    "—Ç—Ä–∏–Ω–∞–¥—Ü–∞—Ç—å": "–ö–∞–ø–∏—Ç–∞–Ω –ü—Ä–æ–µ–∫—Ç–æ–≤",
    "—á–µ—Ç—ã—Ä–Ω–∞–¥—Ü–∞—Ç—å": "–ö–∞–ø–∏—Ç–∞–Ω –ü—Ä–æ–µ–∫—Ç–æ–≤",
}

# –ü–æ–∏—Å–∫ –≤ —Ç–µ–∫—É—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏–∏
message_lower = user_message.lower()
for age_marker, course in age_patterns.items():
    if age_marker in message_lower:
        detected_course = course
        detected_age = age_marker
        break

# –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –≤ —Ç–µ–∫—É—â–µ–º - —Å–º–æ—Ç—Ä–∏–º –≤ –∏—Å—Ç–æ—Ä–∏–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 —Å–æ–æ–±—â–µ–Ω–∏—è)
if not detected_course and history:
    for msg in history[-6:]:  # –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –ø–∞—Ä—ã user-assistant
        if msg.get("role") == "user":
            hist_msg = msg.get("content", "").lower()
            for age_marker, course in age_patterns.items():
                if age_marker in hist_msg:
                    detected_course = course
                    detected_age = age_marker
                    break
            if detected_course:
                break

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ —É—Ç–æ—á–Ω–µ–Ω–∏–µ
needs_course_clarification = False
critical_questions = ["–∑–∞–ø–∏—Å", "–æ—Ñ–æ—Ä–º", "–ø—Ä–æ–≥—Ä–∞–º–º", "–º–µ—Ç–æ–¥–∏–∫", "—á–µ–º—É —É—á–∞—Ç"]

# –£—Ç–æ—á–Ω—è–µ–º –¢–û–õ–¨–ö–û –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
if not detected_course:
    for critical in critical_questions:
        if critical in message_lower:
            needs_course_clarification = True
            break

# –î–æ–±–∞–≤–ª—è–µ–º –≤ result
result["context"] = {
    "detected_course": detected_course,
    "detected_age": detected_age,
    "needs_clarification": needs_course_clarification,
    "clarification_type": "age" if needs_course_clarification else None
}
```

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ ResponseGenerator

**–§–∞–π–ª:** `src/response_generator.py`

**–ì–¥–µ –∏–∑–º–µ–Ω–∏—Ç—å:** –í –º–µ—Ç–æ–¥–µ `generate()`, –ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 46 (–ø–æ–ª—É—á–µ–Ω–∏–µ user_signal)

**–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å:**
```python
# === –û–ë–†–ê–ë–û–¢–ö–ê –ö–û–ù–¢–ï–ö–°–¢–ê –ö–£–†–°–ê (MVP) ===
context_info = router_result.get("context", {})
detected_course = context_info.get("detected_course")
needs_clarification = context_info.get("needs_clarification", False)

# –ë—É–¥–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ –ø—Ä–æ–º–ø—Ç
course_instruction = ""
clarification_instruction = ""

if detected_course:
    # –Ø–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫—É—Ä—Å–∞ –µ—Å—Ç—å
    course_instruction = f"""
–ö–†–ò–¢–ò–ß–ù–û: –í—Å–µ –æ—Ç–≤–µ—Ç—ã –¥–∞–≤–∞–π –¥–ª—è –∫—É—Ä—Å–∞ "{detected_course}".
–í –Ω–∞—á–∞–ª–µ –æ—Ç–≤–µ—Ç–∞ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —É–∫–∞–∂–∏: "–î–ª—è –∫—É—Ä—Å–∞ '{detected_course}'..." –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ.
–ò—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—É—é —ç—Ç–æ–º—É –∫—É—Ä—Å—É.
–ù–ï —É–ø–æ–º–∏–Ω–∞–π –¥—Ä—É–≥–∏–µ –∫—É—Ä—Å—ã, –µ—Å–ª–∏ –Ω–µ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç —è–≤–Ω–æ.
"""
else:
    # –ö–æ–Ω—Ç–µ–∫—Å—Ç –Ω–µ—è—Å–µ–Ω - —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–æ–ø—Ä–æ—Å–∞
    question_text = " ".join(router_result.get("decomposed_questions", [])).lower()
    
    # –î–ª—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ - –¥–∞—ë–º –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
    if any(word in question_text for word in ["—Ü–µ–Ω", "—Å—Ç–æ–∏", "—Å–∫–æ–ª—å–∫", "–ø–ª–∞—Ç"]):
        course_instruction = """
–í–ê–ñ–ù–û: –î–∞–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ü–µ–Ω–∞—Ö –¥–ª—è –í–°–ï–• –∫—É—Ä—Å–æ–≤ –≤ –≤–∏–¥–µ —Å–ø–∏—Å–∫–∞:
‚Ä¢ –Æ–Ω—ã–π –û—Ä–∞—Ç–æ—Ä (7-10 –ª–µ—Ç): 6,000 –≥—Ä–Ω/–º–µ—Å—è—Ü
‚Ä¢ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ö–æ–º–ø–∞—Å (9-12 –ª–µ—Ç): 7,000 –≥—Ä–Ω/–º–µ—Å—è—Ü  
‚Ä¢ –ö–∞–ø–∏—Ç–∞–Ω –ü—Ä–æ–µ–∫—Ç–æ–≤ (11-14 –ª–µ—Ç): 8,000 –≥—Ä–Ω/–º–µ—Å—è—Ü
–£–ø–æ–º—è–Ω–∏ —Å–∫–∏–¥–∫–∏: 10% –∑–∞ –ø–æ–ª–Ω—ã–π –∫—É—Ä—Å, 15% –¥–ª—è 2+ –¥–µ—Ç–µ–π.
"""
    elif any(word in question_text for word in ["—Ä–∞—Å–ø–∏—Å–∞–Ω", "–≤—Ä–µ–º—è", "–∫–æ–≥–¥–∞ –∑–∞–Ω—è—Ç–∏"]):
        course_instruction = """
–°–∫–∞–∂–∏, —á—Ç–æ –≤—Å–µ –∫—É—Ä—Å—ã –ø—Ä–æ—Ö–æ–¥—è—Ç 2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é –ø–æ 90 –º–∏–Ω—É—Ç.
–í—Ä–µ–º—è: 17:00 –∏–ª–∏ 19:00, –µ—Å—Ç—å –≥—Ä—É–ø–ø—ã –≤ –±—É–¥–Ω–∏ –∏ —Å—É–±–±–æ—Ç—É.
–í –∫–æ–Ω—Ü–µ –¥–æ–±–∞–≤—å: "–î–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫—É—Ä—Å–∞ —É–∫–∞–∂–∏—Ç–µ –≤–æ–∑—Ä–∞—Å—Ç —Ä–µ–±—ë–Ω–∫–∞."
"""
    elif needs_clarification:
        # –ö—Ä–∏—Ç–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
        clarification_instruction = """
–í –∫–æ–Ω—Ü–µ –æ—Ç–≤–µ—Ç–∞ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–±–∞–≤—å –≤–µ–∂–ª–∏–≤–æ–µ —É—Ç–æ—á–Ω–µ–Ω–∏–µ:
"–ß—Ç–æ–±—ã –¥–∞—Ç—å –±–æ–ª–µ–µ —Ç–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —É–∫–∞–∂–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–∑—Ä–∞—Å—Ç —Ä–µ–±—ë–Ω–∫–∞."
"""
```

**–ì–¥–µ –∏–∑–º–µ–Ω–∏—Ç—å:** –í —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ system_prompt (—Å—Ç—Ä–æ–∫–∞ ~185-200)

**–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å:**
```python
# –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –∫—É—Ä—Å–∞
if course_instruction:
    system_role += f"\n\n{course_instruction}"
    
if clarification_instruction:
    system_role += f"\n\n{clarification_instruction}"
```

### 4. –ü–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫—É—Ä—Å–∞

**–§–∞–π–ª:** `src/response_generator.py`

**–ì–¥–µ –¥–æ–±–∞–≤–∏—Ç—å:** –ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞ Claude (—Å—Ç—Ä–æ–∫–∞ ~99-115), –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π social_context

**–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å:**
```python
# === –ü–û–°–¢–ü–†–û–¶–ï–°–°–ò–ù–ì –ö–û–ù–¢–ï–ö–°–¢–ê –ö–£–†–°–ê (MVP) ===
# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É–ø–æ–º—è–Ω—É—Ç –ª–∏ –∫—É—Ä—Å, –µ—Å–ª–∏ –º—ã –µ–≥–æ –∑–Ω–∞–µ–º
if detected_course:
    course_names = ["–Æ–Ω—ã–π –û—Ä–∞—Ç–æ—Ä", "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ö–æ–º–ø–∞—Å", "–ö–∞–ø–∏—Ç–∞–Ω –ü—Ä–æ–µ–∫—Ç–æ–≤"]
    course_mentioned = any(name in response_text for name in course_names)
    
    if not course_mentioned:
        # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ
        # –ù–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –ª–∏ —É–∂–µ —Å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
        if response_text.startswith(("–ü—Ä–∏–≤–µ—Ç", "–ó–¥—Ä–∞–≤—Å—Ç–≤", "–î–æ–±—Ä")):
            # –í—Å—Ç–∞–≤–ª—è–µ–º –ø–æ—Å–ª–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
            parts = response_text.split("!", 1)
            if len(parts) == 2:
                response_text = f"{parts[0]}! –î–ª—è –∫—É—Ä—Å–∞ '{detected_course}': {parts[1]}"
            else:
                response_text = f"{parts[0]} –î–ª—è –∫—É—Ä—Å–∞ '{detected_course}'."
        else:
            # –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–∞–º–æ–µ –Ω–∞—á–∞–ª–æ
            response_text = f"–î–ª—è –∫—É—Ä—Å–∞ '{detected_course}': {response_text}"
```

### 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

**–ù–ï –ú–ï–ù–Ø–ï–ú** —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ª–æ–≥–∏–∫—É –∏—Å—Ç–æ—Ä–∏–∏ –≤ `history_manager.py`

–ò—Å–ø–æ–ª—å–∑—É–µ–º –∏—Å—Ç–æ—Ä–∏—é —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è –≤ Router –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (—É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤—ã—à–µ).

## üìä –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### –¢–µ—Å—Ç 1: –Ø–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
```
User: "–ö—É—Ä—Å –¥–ª—è 9 –ª–µ—Ç"
Expected: –û–ø—Ä–µ–¥–µ–ª—ë–Ω "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ö–æ–º–ø–∞—Å"
User: "–°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç?"
Expected: "–î–ª—è –∫—É—Ä—Å–∞ '–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ö–æ–º–ø–∞—Å': 7,000 –≥—Ä–Ω/–º–µ—Å—è—Ü"
```

### –¢–µ—Å—Ç 2: –ù–µ—è–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å —Ü–µ–Ω–æ–π
```
User: "–°–∫–æ–ª—å–∫–æ —Å—Ç–æ—è—Ç –≤–∞—à–∏ –∫—É—Ä—Å—ã?"
Expected: –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç—Ä—ë—Ö –∫—É—Ä—Å–æ–≤ —Å —Ü–µ–Ω–∞–º–∏
```

### –¢–µ—Å—Ç 3: –°–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
```
User: "–ß—Ç–æ –µ—Å—Ç—å –¥–ª—è 9 –ª–µ—Ç?"
Expected: "–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ö–æ–º–ø–∞—Å"
User: "–ê –¥–ª—è —Å–µ–º–∏–ª–µ—Ç–∫–∏?"
Expected: "–Æ–Ω—ã–π –û—Ä–∞—Ç–æ—Ä" (–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
```

### –¢–µ—Å—Ç 4: –ö—Ä–∏—Ç–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
```
User: "–•–æ—á—É –∑–∞–ø–∏—Å–∞—Ç—å—Å—è"
Expected: –û—Ç–≤–µ—Ç + "–£–∫–∞–∂–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–∑—Ä–∞—Å—Ç —Ä–µ–±—ë–Ω–∫–∞"
```

## ‚ö†Ô∏è –ß—Ç–æ –ù–ï —Ç—Ä–æ–≥–∞–µ–º

1. **history_manager.py** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –µ—Å—Ç—å
2. **–õ–æ–≥–∏–∫—É user_signal** - —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
3. **offers_catalog.py** - CTA –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å
4. **–ö—Ä–∞—Ç–∫–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤** - –æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞
5. **–í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ** - —Ñ–æ–∫—É—Å —Ç–æ–ª—å–∫–æ –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∫—É—Ä—Å–æ–≤

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

1. ‚úÖ –†–∞–∑–º–µ—Ä –≥—Ä—É–ø–ø —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –≤–æ –≤—Å–µ—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö
2. ‚úÖ Router –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫—É—Ä—Å –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É
3. ‚úÖ Generator –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫—É—Ä—Å–∞
4. ‚úÖ –í –æ—Ç–≤–µ—Ç–∞—Ö —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫—É—Ä—Å
5. ‚úÖ –ü—Ä–∏ –Ω–µ—è—Å–Ω–æ—Å—Ç–∏ –¥–∞—ë—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –≤—Å–µ–º –∫—É—Ä—Å–∞–º
6. ‚úÖ –£—Ç–æ—á–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤

## üí° –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (–ø–æ—Å–ª–µ MVP)

- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–µ—Ç–µ–π —Ä–∞–∑–Ω–æ–≥–æ –≤–æ–∑—Ä–∞—Å—Ç–∞
- –£–º–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –ó–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∫—É—Ä—Å–∞ –¥–ª—è user_id
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏–π ("–¥–ª—è –Ω–µ—ë", "—Å—Ç–∞—Ä—à–∏–π")

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –õ—É—á—à–µ –¥–∞—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, —á–µ–º –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é
2. **–°—Ç–∏–ª—å:** "–î–ª—è –∫—É—Ä—Å–∞ X" –∑–≤—É—á–∏—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ –∏ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ
3. **Fallback:** –ü—Ä–∏ –ª—é–±—ã—Ö —Å–æ–º–Ω–µ–Ω–∏—è—Ö ‚Üí –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –≤—Å–µ–º –∫—É—Ä—Å–∞–º
4. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:** –ù–µ —Ç—Ä–æ–≥–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ª–æ–≥–∏–∫—É user_signal –∏ CTA

---

**–ê–≤—Ç–æ—Ä:** Claude (Opus 4.1)  
**–î–ª—è:** –°–ª–µ–¥—É—é—â–µ–π —Å–µ—Å—Å–∏–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ MVP  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏