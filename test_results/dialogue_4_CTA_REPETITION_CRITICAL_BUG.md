# üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: –ù–∞–≤—è–∑—á–∏–≤—ã–µ –ø–æ–≤—Ç–æ—Ä—ã CTA –¥–ª—è price_sensitive

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í –¥–∏–∞–ª–æ–≥–µ 4 "–°–∫–µ–ø—Ç–∏–∫-—Ç–æ—Ä–≥–æ–≤–µ—Ü" –≤—ã—è–≤–ª–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –Ω–∞–≤—è–∑—á–∏–≤—ã–º–∏ –ø–æ–≤—Ç–æ—Ä–∞–º–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–≥–æ CTA —Ç–µ–∫—Å—Ç–∞.

### –§–∞–∫—Ç—ã:
- **4 –∏–∑ 5 –æ—Ç–≤–µ—Ç–æ–≤** –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è –ò–î–ï–ù–¢–ò–ß–ù–´–ú —Ç–µ–∫—Å—Ç–æ–º:
```
üí∞ –ö—Å—Ç–∞—Ç–∏, —É –Ω–∞—Å –¥–µ–π—Å—Ç–≤—É—é—Ç —Å–∫–∏–¥–∫–∏: 10% –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –æ–ø–ª–∞—Ç–µ –∫—É—Ä—Å–∞, 
15% –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞ –∏–∑ —Å–µ–º—å–∏, –∏ 20% –¥–ª—è —Å–µ–º–µ–π –≤ —Å–ª–æ–∂–Ω–æ–π –∂–∏–∑–Ω–µ–Ω–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏.
```
- **80% –ø–æ–≤—Ç–æ—Ä–æ–≤** –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Ç–µ–∫—Å—Ç–∞ —Å–ª–æ–≤–æ –≤ —Å–ª–æ–≤–æ
- **0% –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏** –≤ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞—Ö

### –°–∞–º—ã–π –∞–±—Å—É—Ä–¥–Ω—ã–π –ø—Ä–∏–º–µ—Ä (–°–æ–æ–±—â–µ–Ω–∏–µ 5):
```
User: –°–∫–∏–¥–∫–∏ —Ö–æ—Ç—å –µ—Å—Ç—å? –ò–ª–∏ —Ç–æ–ª—å–∫–æ –¥—É—Ä–∞—á–∫–æ–≤ –∑–∞ –ø–æ–ª–Ω—É—é —Ü–µ–Ω—É –±–µ—Ä—ë—Ç–µ?
Bot: –£ –Ω–∞—Å –µ—Å—Ç—å —Å–∫–∏–¥–∫–∞ 10% –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –æ–ø–ª–∞—Ç–µ –∫—É—Ä—Å–∞...
     [–ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ –≤—Å–µ —Å–∫–∏–¥–∫–∏]
     ...
     üí∞ –ö—Å—Ç–∞—Ç–∏, —É –Ω–∞—Å –¥–µ–π—Å—Ç–≤—É—é—Ç —Å–∫–∏–¥–∫–∏: 10% –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –æ–ø–ª–∞—Ç–µ –∫—É—Ä—Å–∞...
     [–ü–û–í–¢–û–†–Ø–ï–¢ –¢–û –ñ–ï –°–ê–ú–û–ï]
```

## –ö–æ—Ä–Ω–µ–≤—ã–µ –ø—Ä–∏—á–∏–Ω—ã (–∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞)

### 1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ `offers_catalog.py`

```python
# –°—Ç—Ä–æ–∫–∏ 8-12
"price_sensitive": {
    "text": "üí∞ –ö—Å—Ç–∞—Ç–∏, —É –Ω–∞—Å –¥–µ–π—Å—Ç–≤—É—é—Ç —Å–∫–∏–¥–∫–∏...",  # –¢–û–õ–¨–ö–û –û–î–ò–ù –í–ê–†–ò–ê–ù–¢
    "priority": "medium",
    "placement": "end"
}
```

–°—Ä–∞–≤–Ω–∏—Ç–µ —Å `anxiety_about_child`:
```python
# –°—Ç—Ä–æ–∫–∏ 14-22
"anxiety_about_child": {
    "text_variants": [  # –¢–†–ò –†–ê–ó–ù–´–• –í–ê–†–ò–ê–ù–¢–ê!
        "üíö –ú—ã –ø–æ–Ω–∏–º–∞–µ–º –≤–∞—à–∏ –ø–µ—Ä–µ–∂–∏–≤–∞–Ω–∏—è...",
        "üíö –ù–∞–ø–æ–º–∏–Ω–∞–µ–º: –ø–µ—Ä–≤–∞—è –≤—Å—Ç—Ä–µ—á–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è...",
        "üíö –ö—Å—Ç–∞—Ç–∏, –ø—Ä–æ–±–Ω–æ–µ –∑–∞–Ω—è—Ç–∏–µ —É –Ω–∞—Å –±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ..."
    ]
}
```

### 2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting –≤ `response_generator.py`

–ú–µ—Ç–æ–¥ `_should_add_offer` (—Å—Ç—Ä–æ–∫–∏ 431-470):
- ‚úÖ –ï—Å—Ç—å –∑–∞—â–∏—Ç–∞ –¥–ª—è `anxiety_about_child` (–Ω–µ —á–∞—â–µ —Ä–∞–∑–∞ –≤ 3 —Å–æ–æ–±—â–µ–Ω–∏—è)
- ‚ùå –ù–ï–¢ –∑–∞—â–∏—Ç—ã –¥–ª—è `price_sensitive` (–¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –í–°–ï–ì–î–ê)

```python
if user_signal == "anxiety_about_child":
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π...
    if any(marker in msg_content for marker in anxiety_cta_markers):
        print("üîÑ Rate limiting: CTA –¥–ª—è anxiety –±—ã–ª –Ω–µ–¥–∞–≤–Ω–æ, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
        return False

# –î–ª—è price_sensitive - –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫!
return True
```

### 3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏

CTA –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏, –±–µ–∑ —É—á—ë—Ç–∞:
- –û —á—ë–º –±—ã–ª –≤–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ß—Ç–æ —É–∂–µ –±—ã–ª–æ —Å–∫–∞–∑–∞–Ω–æ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –æ—Ç–≤–µ—Ç–µ
- –°–∫–æ–ª—å–∫–æ —Ä–∞–∑ CTA —É–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª—Å—è

## –í–ª–∏—è–Ω–∏–µ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç

1. **–°–æ–∑–¥–∞—ë—Ç –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ —Ä–æ–±–æ—Ç–∞-–ø—Ä–æ–¥–∞–≤—Ü–∞** –≤–º–µ—Å—Ç–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
2. **–†–∞–∑–¥—Ä–∞–∂–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** - –æ—Å–æ–±–µ–Ω–Ω–æ price_sensitive, –∫–æ—Ç–æ—Ä—ã–µ –∏ —Ç–∞–∫ —Å–∫–µ–ø—Ç–∏—á–Ω—ã
3. **–°–Ω–∏–∂–∞–µ—Ç –¥–æ–≤–µ—Ä–∏–µ** - –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –Ω–∞–≤—è–∑—á–∏–≤–∞—è —Ä–µ–∫–ª–∞–º–∞
4. **–ê–±—Å—É—Ä–¥–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏** - –∫–æ–≥–¥–∞ –±–æ—Ç –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–≤–∞–∂–¥—ã –ø–æ–¥—Ä—è–¥

## –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

### –°—Ä–æ—á–Ω—ã–µ (Quick fix):

#### 1. –î–æ–±–∞–≤–∏—Ç—å –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è price_sensitive
```python
"price_sensitive": {
    "text_variants": [
        "üí∞ –ö—Å—Ç–∞—Ç–∏, —É –Ω–∞—Å –¥–µ–π—Å—Ç–≤—É—é—Ç —Å–∫–∏–¥–∫–∏: 10% –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –æ–ø–ª–∞—Ç–µ –∫—É—Ä—Å–∞, 15% –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞ –∏–∑ —Å–µ–º—å–∏.",
        "üí∞ –î–æ—Å—Ç—É–ø–Ω–∞ —Ä–∞—Å—Å—Ä–æ—á–∫–∞ –±–µ–∑ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –Ω–∞ 3 –º–µ—Å—è—Ü–∞. –¢–∞–∫–∂–µ –µ—Å—Ç—å —Å–µ–º–µ–π–Ω—ã–µ —Å–∫–∏–¥–∫–∏ –¥–æ 20%.",
        "üí∞ –ù–∞–ø–æ–º–∏–Ω–∞–µ–º –ø—Ä–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–ø—Ü–∏–∏: —Å–∫–∏–¥–∫–∞ 10% –∑–∞ –ø–æ–ª–Ω—É—é –æ–ø–ª–∞—Ç—É, —Ä–∞—Å—Å—Ä–æ—á–∫–∞ –Ω–∞ 3 –º–µ—Å—è—Ü–∞.",
        "üí∞ –£ –Ω–∞—Å –≥–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø–ª–∞—Ç—ã: —Å–∫–∏–¥–∫–∏, —Ä–∞—Å—Å—Ä–æ—á–∫–∞, —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è —Å–µ–º–µ–π."
    ],
    "priority": "medium",
    "placement": "end"
}
```

#### 2. –î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è price_sensitive
```python
def _should_add_offer(self, user_signal: str, history: list, offer: dict) -> bool:
    # ...—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥...
    
    # –î–æ–±–∞–≤–∏—Ç—å –¥–ª—è price_sensitive
    if user_signal == "price_sensitive":
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 —Å–æ–æ–±—â–µ–Ω–∏—è
        recent_count = 0
        for msg in history[-6:]:
            if msg.get("role") == "assistant" and "üí∞" in msg.get("content", ""):
                recent_count += 1
        
        # –ù–µ —á–∞—â–µ —á–µ–º –∫–∞–∂–¥–æ–µ –≤—Ç–æ—Ä–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        if recent_count >= 2:
            print("üîÑ Rate limiting: CTA –¥–ª—è price_sensitive –±—ã–ª –Ω–µ–¥–∞–≤–Ω–æ")
            return False
```

#### 3. –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```python
# –í response_generator.py, –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º CTA
def _should_add_offer(self, user_signal: str, history: list, offer: dict) -> bool:
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å–ø—Ä–∞—à–∏–≤–∞–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä—è–º–æ –æ —Ç–æ–º, —á—Ç–æ –≤ CTA
    if history:
        last_user_msg = ""
        for msg in reversed(history):
            if msg.get("role") == "user":
                last_user_msg = msg.get("content", "").lower()
                break
        
        # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø—Ä–æ —Å–∫–∏–¥–∫–∏, –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º CTA –ø—Ä–æ —Å–∫–∏–¥–∫–∏
        if user_signal == "price_sensitive":
            skip_keywords = ["—Å–∫–∏–¥–∫", "–¥–µ—à–µ–≤–ª", "—Ä–∞—Å—Å—Ä–æ—á–∫", "–æ–ø–ª–∞—Ç"]
            if any(keyword in last_user_msg for keyword in skip_keywords):
                print("üîÑ –ü—Ä–æ–ø—É—Å–∫–∞–µ–º CTA - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ–± —ç—Ç–æ–º")
                return False
```

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

#### 1. –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ CTA
- –ê–Ω–∞–ª–∏–∑ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º CTA
- –ï—Å–ª–∏ –≤ –æ—Ç–≤–µ—Ç–µ —É–∂–µ –µ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∫–∏–¥–∫–∞—Ö - –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è CTA –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å

#### 2. A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—É—é —á–∞—Å—Ç–æ—Ç—É CTA
- –ò–∑–º–µ—Ä—è—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é —Å —Ä–∞–∑–Ω—ã–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ —Ç–µ–∫—Å—Ç–∞
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

#### 3. –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
- –û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –º–æ–º–µ–Ω—Ç –¥–ª—è CTA
- –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô üî¥

**–ü–æ—á–µ–º—É –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π:**
1. –ù–∞–ø—Ä—è–º—É—é –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏—é price_sensitive –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. –°–æ–∑–¥–∞—ë—Ç –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç
3. –õ–µ–≥–∫–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å (–Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞)
4. –ë–æ–ª—å—à–æ–π –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö —É—Å–∏–ª–∏—è—Ö

## –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

- [ ] –ù–µ –±–æ–ª–µ–µ 1 –ø–æ–≤—Ç–æ—Ä–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–≥–æ CTA –≤ –¥–∏–∞–ª–æ–≥–µ
- [ ] –ú–∏–Ω–∏–º—É–º 3 —Ä–∞–∑–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è price_sensitive
- [ ] CTA –Ω–µ —á–∞—â–µ —á–µ–º —Ä–∞–∑ –≤ 2-3 —Å–æ–æ–±—â–µ–Ω–∏—è
- [ ] –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–æ—Å–Ω–æ–≤–Ω–æ–π –æ—Ç–≤–µ—Ç + CTA)

## –í—ã–≤–æ–¥—ã

–≠—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞ - –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä —Ç–æ–≥–æ, –∫–∞–∫ –º–∞–ª–µ–Ω—å–∫–∞—è –¥–µ—Ç–∞–ª—å –º–æ–∂–µ—Ç —Ä–∞–∑—Ä—É—à–∏—Ç—å –≤–µ—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç. –î–ª—è price_sensitive –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∏ —Ç–∞–∫ —Å–∫–µ–ø—Ç–∏—á–Ω—ã, —Ç–∞–∫–∏–µ –Ω–∞–≤—è–∑—á–∏–≤—ã–µ –ø–æ–≤—Ç–æ—Ä—ã –º–æ–≥—É—Ç —Å—Ç–∞—Ç—å –ø—Ä–∏—á–∏–Ω–æ–π –æ—Ç–∫–∞–∑–∞ –æ—Ç —É—Å–ª—É–≥–∏.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø–µ—Ä–µ–¥ production –∑–∞–ø—É—Å–∫–æ–º.