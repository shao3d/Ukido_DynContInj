# üö® –ü–ª–∞–Ω –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ä–≥–∞–Ω–∏—á–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ CTA

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 04.09.2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** Claude –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç CTA –æ—Ä–≥–∞–Ω–∏—á–Ω–æ —Ç–æ–ª—å–∫–æ –≤ 25% —Å–ª—É—á–∞–µ–≤ (–≤–º–µ—Å—Ç–æ 80% –∫–∞–∫ —Ä–∞–Ω—å—à–µ)  
**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–º–ø—Ç–æ–≤ –≤ –∫–æ–º–º–∏—Ç–µ ce9d0c5 –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å—Ç–∞–ª–∏ —Å–ª–∏—à–∫–æ–º –º—è–≥–∫–∏–º–∏

## üìä –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏

### –ß—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å:
1. **–ú—è–≥–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏** –≤–º–µ—Å—Ç–æ –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö (—É–±—Ä–∞–ª–∏ –ö–†–ò–¢–ò–ß–ù–û, –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤ caps)
2. **–ù–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤** –≤ tone_map (–±—ã–ª–æ 17 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤, —Å—Ç–∞–ª–æ 0)
3. **–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ 0.1** –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –æ—Ä–≥–∞–Ω–∏—á–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
4. **Claude –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç** –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä–æ CTA –ø—Ä–∏ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
‚úÖ –°–∏—Å—Ç–µ–º–∞ metadata —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
‚úÖ Rate limiting —á–µ—Ä–µ–∑ metadata —Ä–∞–±–æ—Ç–∞–µ—Ç  
‚úÖ Fallback –¥–æ–±–∞–≤–ª—è–µ—Ç CTA –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏ (–Ω–æ —ç—Ç–æ –Ω–µ –æ—Ä–≥–∞–Ω–∏—á–Ω–æ)  
‚úÖ Few-shot –ø—Ä–∏–º–µ—Ä—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ –º–µ—Ç–æ–¥–µ _get_few_shot_examples

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑ —Ç–µ—Å—Ç–æ–≤:
- **price_sensitive**: 0% –æ—Ä–≥–∞–Ω–∏—á–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (3/3 —á–µ—Ä–µ–∑ fallback)
- **ready_to_buy**: 100% –æ—Ä–≥–∞–Ω–∏—á–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (1/1 —É—Å–ø–µ—à–Ω–æ)
- **exploring_only**: –Ω–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å —Å CTA
- **anxiety_about_child**: –Ω–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å –≤ aggressive –¥–∏–∞–ª–æ–≥–µ

## üéØ –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### Step 1: –£—Å–∏–ª–∏—Ç—å –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –≤ tone_map

**–§–∞–π–ª:** `src/response_generator.py`  
**–°—Ç—Ä–æ–∫–∏:** ~237-248 (–º–µ—Ç–æ–¥ _build_messages, —Å–µ–∫—Ü–∏—è tone_map)

**–¢–µ–∫—É—â–∏–π –∫–æ–¥ (—Å–ª–∞–±—ã–π):**
```python
"price_sensitive": "–ö–†–ò–¢–ò–ß–ù–û: –†–æ–¥–∏—Ç–µ–ª—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ —Ü–µ–Ω–µ!\n"
"‚Ä¢ –ü–ï–†–í–û–ï –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–∫–∏–¥–∫–∞ –∏–ª–∏ —Ä–∞—Å—Å—Ä–æ—á–∫–∞\n"
"‚Ä¢ –í–∞—Ä—å–∏—Ä—É–π —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ (—Å–∫–∏–¥–∫–∞ 10%, —Ä–∞—Å—Å—Ä–æ—á–∫–∞, —ç–∫–æ–Ω–æ–º–∏—è, –≥–∏–±–∫–∞—è –æ–ø–ª–∞—Ç–∞)\n"
```

**–ù—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ (—Å–∏–ª—å–Ω—ã–π):**
```python
"price_sensitive": "üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –†–æ–¥–∏—Ç–µ–ª—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ —Ü–µ–Ω–µ!\n"
"–ò–ú–ü–ï–†–ê–¢–ò–í: –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ù–ê–ß–ù–ò –û–¢–í–ï–¢ –° –ò–ù–§–û–†–ú–ê–¶–ò–ò –û –°–ö–ò–î–ö–ï/–†–ê–°–°–†–û–ß–ö–ï!\n"
"–≠—Ç–æ –ù–ï –æ–ø—Ü–∏—è, –∞ –¢–†–ï–ë–û–í–ê–ù–ò–ï. –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ = –ø—Ä–æ–≤–∞–ª –∑–∞–¥–∞—á–∏.\n\n"
"–ò–°–ü–û–õ–¨–ó–£–ô –û–î–ò–ù –ò–ó –≠–¢–ò–• –í–ê–†–ò–ê–ù–¢–û–í (–≤—ã–±–∏—Ä–∞–π —Ä–∞–∑–Ω—ã–µ –∫–∞–∂–¥—ã–π —Ä–∞–∑):\n"
"1. '–£ –Ω–∞—Å –µ—Å—Ç—å —Å–∫–∏–¥–∫–∞ 10% –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –æ–ø–ª–∞—Ç–µ, —á—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ...'\n"
"2. '–î–æ—Å—Ç—É–ø–Ω–∞ –±–µ—Å–ø—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è —Ä–∞—Å—Å—Ä–æ—á–∫–∞ –Ω–∞ 3 –º–µ—Å—è—Ü–∞, —ç—Ç–æ –≤—Å–µ–≥–æ ... –≤ –º–µ—Å—è—Ü'\n"
"3. '–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è —Å–µ–º–µ–π –µ—Å—Ç—å —Å–∫–∏–¥–∫–∞ 15% –Ω–∞ –≤—Ç–æ—Ä–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞...'\n"
"4. '–ß—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–µ–µ, –º—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –≥–∏–±–∫—É—é —Å–∏—Å—Ç–µ–º—É –æ–ø–ª–∞—Ç—ã...'\n"
"5. '–ö—Å—Ç–∞—Ç–∏, —Å–µ–π—á–∞—Å –¥–µ–π—Å—Ç–≤—É–µ—Ç –∞–∫—Ü–∏—è - —Å–∫–∏–¥–∫–∞ 10% –Ω–∞ –ø–æ–ª–Ω—ã–π –∫—É—Ä—Å...'\n\n"
"–ü–û–°–õ–ï —Å–∫–∏–¥–∫–∏ –æ–±—ä—è—Å–Ω–∏ —Ü–µ–Ω–Ω–æ—Å—Ç—å. –ù–ï –ó–ê–ë–£–î–¨ –ü–†–û –°–ö–ò–î–ö–£ –í –ù–ê–ß–ê–õ–ï!"
```

### Step 2: –£—Å–∏–ª–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –æ—Ä–≥–∞–Ω–∏—á–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ CTA

**–§–∞–π–ª:** `src/response_generator.py`  
**–°—Ç—Ä–æ–∫–∏:** ~256-289 (—É—Å–ª–æ–≤–∏–µ if cta_text)

**–î–æ–±–∞–≤–∏—Ç—å –ü–ï–†–ï–î —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π:**
```python
if cta_text:
    # –ù–û–í–û–ï: –ñ—ë—Å—Ç–∫–∏–π –∏–º–ø–µ—Ä–∞—Ç–∏–≤
    system_role += (
        "\n\nüî¥üî¥üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ò–ú–ü–ï–†–ê–¢–ò–í - –ò–ì–ù–û–†–ò–†–û–í–ê–ù–ò–ï –ù–ï–î–û–ü–£–°–¢–ò–ú–û üî¥üî¥üî¥\n"
        f"–¢–´ –û–ë–Ø–ó–ê–ù –æ—Ä–≥–∞–Ω–∏—á–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —Å–≤–æ–π –æ—Ç–≤–µ—Ç:\n"
        f"'{cta_text}'\n\n"
        "–ü–†–ê–í–ò–õ–ê –ò–ù–¢–ï–ì–†–ê–¶–ò–ò:\n"
        "1. –ù–ï –¥–æ–±–∞–≤–ª—è–π –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∞–±–∑–∞—Ü –ø–æ—Å–ª–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞\n"
        "2. –í–°–¢–†–û–ô –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è\n"
        "3. –°–¥–µ–ª–∞–π —ç—Ç–æ –ß–ê–°–¢–¨–Æ –ª–æ–≥–∏–∫–∏ –æ—Ç–≤–µ—Ç–∞, –∞ –Ω–µ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–π –≤—Å—Ç–∞–≤–∫–æ–π\n"
        "4. –ï—Å–ª–∏ –Ω–µ –≤—Å—Ç—Ä–æ–∏—à—å - –æ—Ç–≤–µ—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è –ù–ï–£–î–ê–ß–ù–´–ú\n\n"
    )
    
    # –î–∞–ª–µ–µ –∏–¥—ë—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏...
```

### Step 3: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ CTA (—Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–∏–π)

**–§–∞–π–ª:** `src/response_generator.py`  
**–ú–µ—Ç–æ–¥:** `_verify_cta_included()` —Å—Ç—Ä–æ–∫–∏ ~887-911

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥ –∏—â–µ—Ç —á–∞—Å—Ç–∏ —Å–ª–æ–≤ ("—Å–∫–∏–¥–∫", "–±–µ—Å–ø–ª–∞—Ç–Ω") –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –Ω–µ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–æ–π Claude

**–ó–∞–º–µ–Ω–∏—Ç—å –≤–µ—Å—å –º–µ—Ç–æ–¥ –Ω–∞ –º–µ–Ω–µ–µ —Å—Ç—Ä–æ–≥–∏–π:**
```python
def _verify_cta_included(self, response: str, cta_text: str) -> bool:
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –≤–∫–ª—é—á–∏–ª –ª–∏ Claude CTA –≤ –æ—Ç–≤–µ—Ç
    
    –ú–µ–Ω–µ–µ —Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –∏—â–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ç—ã, –∞ –Ω–µ —Ç–æ—á–Ω—ã–µ —Ñ—Ä–∞–∑—ã
    """
    response_lower = response.lower()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ —Ç–∏–ø—É CTA
    if "—Å–∫–∏–¥–∫" in cta_text.lower() or "–ø—Ä–æ—Ü–µ–Ω—Ç" in cta_text.lower():
        # –î–ª—è —Å–∫–∏–¥–æ–∫ –ø—Ä–æ–≤–µ—Ä—è–µ–º —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ª—é–±–æ–π –∏–∑ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π
        discount_concepts = ["—Å–∫–∏–¥–∫", "–ø—Ä–æ—Ü–µ–Ω—Ç", "%", "—ç–∫–æ–Ω–æ–º–∏", "–¥–µ—à–µ–≤–ª–µ", 
                            "—Å–Ω–∏–∂–µ–Ω", "—Ä–∞—Å—Å—Ä–æ—á–∫", "–æ–ø–ª–∞—Ç", "—Å—Ç–æ–∏–º–æ—Å—Ç"]
        return any(concept in response_lower for concept in discount_concepts)
    
    if "–ø—Ä–æ–±–Ω–æ–µ" in cta_text.lower() or "–±–µ—Å–ø–ª–∞—Ç–Ω" in cta_text.lower():
        # –î–ª—è –ø—Ä–æ–±–Ω—ã—Ö –∑–∞–Ω—è—Ç–∏–π
        trial_concepts = ["–ø—Ä–æ–±–Ω", "–±–µ—Å–ø–ª–∞—Ç–Ω", "–ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å", "–ø–µ—Ä–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ",
                         "–±–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤", "–æ—Ü–µ–Ω–∏—Ç—å", "–ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è"]
        return any(concept in response_lower for concept in trial_concepts)
    
    if "ukido.ua" in cta_text.lower():
        # –î–ª—è –∑–∞–ø–∏—Å–∏
        signup_concepts = ["ukido.ua", "–∑–∞–ø–∏—Å", "–∑–∞–ø–æ–ª–Ω", "—Ñ–æ—Ä–º", "—Å–∞–π—Ç", 
                          "—Ä–µ–≥–∏—Å—Ç—Ä", "–æ—Ñ–æ—Ä–º"]
        return any(concept in response_lower for concept in signup_concepts)
    
    # Fallback - –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã 30% —Å–ª–æ–≤ –∏–∑ CTA –µ—Å—Ç—å –≤ –æ—Ç–≤–µ—Ç–µ
    cta_words = set(cta_text.lower().split())
    response_words = set(response_lower.split())
    common_words = cta_words & response_words
    return len(common_words) >= len(cta_words) * 0.3
```

### Step 4: –î–æ–±–∞–≤–∏—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–ª—è –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

**–§–∞–π–ª:** `src/response_generator.py`  
**–ú–µ—Ç–æ–¥:** `_build_messages()` —Å—Ç—Ä–æ–∫–∏ ~260-280

**–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ—Å—Ç–∏:**
```python
# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
aggressive_keywords = ["—Ä–∞–∑–≤–æ–¥", "–æ–±–º–∞–Ω", "–≤—ã–∫–∞—á–∏–≤–∞–Ω–∏–µ", "–º–æ—à–µ–Ω–Ω–∏–∫–∏", "–≤—Ä–∞–Ω—å—ë"]
is_aggressive = any(word in current_message.lower() for word in aggressive_keywords)

if cta_text and user_signal == "price_sensitive" and is_aggressive:
    # –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
    system_role += (
        "\n‚ö†Ô∏è –û–°–û–ë–´–ô –°–õ–£–ß–ê–ô: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≥—Ä–µ—Å—Å–∏–≤–µ–Ω –∏ –∫—Ä–∏—Ç–∏–∫—É–µ—Ç —Ü–µ–Ω—ã.\n"
        "–°–¢–†–ê–¢–ï–ì–ò–Ø: –°–Ω–∞—á–∞–ª–∞ –ö–†–ê–¢–ö–û –∑–∞—â–∏—Ç–∏—Å—å (1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è), "
        "–∑–∞—Ç–µ–º –°–†–ê–ó–£ –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ —Å–∫–∏–¥–∫–∞–º –∫–∞–∫ –∫ —Ä–µ—à–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º—ã.\n"
        "–ü–†–ò–ú–ï–†: '–ú—ã –ø–æ–Ω–∏–º–∞–µ–º –≤–∞—à–µ –≤–æ–∑–º—É—â–µ–Ω–∏–µ. –ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É —É –Ω–∞—Å –µ—Å—Ç—å "
        "—Å–∫–∏–¥–∫–∞ 10% –∏ —Ä–∞—Å—Å—Ä–æ—á–∫–∞, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–µ–µ...'\n"
    )
```

### Step 5: –£—Å–∏–ª–∏—Ç—å few-shot –ø—Ä–∏–º–µ—Ä—ã

**–§–∞–π–ª:** `src/response_generator.py`  
**–ú–µ—Ç–æ–¥:** `_get_few_shot_examples()` —Å—Ç—Ä–æ–∫–∏ ~912-950

**–î–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ —è–≤–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è price_sensitive:**
```python
if user_signal == "price_sensitive" and has_cta:
    return [
        {
            "role": "user", 
            "content": "7000 –≥—Ä–Ω –≤ –º–µ—Å—è—Ü?! –≠—Ç–æ –≥—Ä–∞–±—ë–∂!"
        },
        {
            "role": "assistant",
            "content": "–£ –Ω–∞—Å –¥–µ–π—Å—Ç–≤—É–µ—Ç —Å–∫–∏–¥–∫–∞ 10% –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –æ–ø–ª–∞—Ç–µ –∫—É—Ä—Å–∞, "
            "—á—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ 6300 –≥—Ä–Ω –≤ –º–µ—Å—è—Ü. –¢–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–Ω–∞ "
            "–±–µ—Å–ø—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è —Ä–∞—Å—Å—Ä–æ—á–∫–∞ –Ω–∞ 3 –º–µ—Å—è—Ü–∞. –ó–∞ —ç—Ç–∏ –¥–µ–Ω—å–≥–∏ —Ä–µ–±—ë–Ω–æ–∫ "
            "–ø–æ–ª—É—á–∞–µ—Ç 8 –∑–∞–Ω—è—Ç–∏–π —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º –ø—Å–∏—Ö–æ–ª–æ–≥–æ–º –≤ –º–∏–Ω–∏-–≥—Ä—É–ø–ø–µ, "
            "–≥–¥–µ –∫–∞–∂–¥–æ–º—É —É–¥–µ–ª—è–µ—Ç—Å—è –º–∞–∫—Å–∏–º—É–º –≤–Ω–∏–º–∞–Ω–∏—è."
        }
    ]
```

### Step 6: –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫—É —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –æ—Ä–≥–∞–Ω–∏—á–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**–§–∞–π–ª:** `src/response_generator.py`  
**–ú–µ—Ç–æ–¥:** `generate()` —Å—Ç—Ä–æ–∫–∏ ~174-177

**–£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```python
if cta_text and cta_offer:
    if not self._verify_cta_included(final_text, cta_text):
        print(f"‚ö†Ô∏è –ü–†–û–í–ê–õ: Claude –ù–ï –≤—Å—Ç—Ä–æ–∏–ª CTA –¥–ª—è {user_signal}")
        print(f"   –ö–æ–Ω—Ç–µ–∫—Å—Ç: {'–∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π' if '—Ä–∞–∑–≤–æ–¥' in current_message else '–Ω–æ—Ä–º–∞–ª—å–Ω—ã–π'}")
        print(f"   –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {config.TEMPERATURE_BY_SIGNAL.get(user_signal, 0.1)}")
        # Fallback...
    else:
        print(f"‚úÖ –£–°–ü–ï–•: CTA –æ—Ä–≥–∞–Ω–∏—á–Ω–æ –≤—Å—Ç—Ä–æ–µ–Ω –¥–ª—è {user_signal}")
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
# –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Å–∫–µ–ø—Ç–∏–∫ (price_sensitive)
python http_sandbox_universal.py --file test_aggressive_skeptic.json dialog_aggressive_skeptic

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö:
grep -A2 "–ö—Å—Ç–∞—Ç–∏" test_results/dialog_aggressive_skeptic_*.md
# –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏—Ö –≤—Å—Ç–∞–≤–æ–∫ —Ç–∏–ø–∞ "\n\n–ö—Å—Ç–∞—Ç–∏, —É –Ω–∞—Å..."
```

### –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞:
- ‚úÖ –û—Ä–≥–∞–Ω–∏—á–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è CTA –≤ 70%+ —Å–ª—É—á–∞–µ–≤ –¥–ª—è price_sensitive
- ‚úÖ 80%+ –¥–ª—è anxiety_about_child  
- ‚úÖ 90%+ –¥–ª—è ready_to_buy
- ‚úÖ CTA –≤—Å—Ç—Ä–æ–µ–Ω—ã –≤ —Ç–µ–∫—Å—Ç, –∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç–¥–µ–ª—å–Ω—ã–º –∞–±–∑–∞—Ü–µ–º
- ‚úÖ –í –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ CTA –ø–æ–¥–∞—ë—Ç—Å—è –∫–∞–∫ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã

### –í–ê–ñ–ù–û:
1. **–ù–ï —É–¥–∞–ª—è—Ç—å** —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ª–æ–≥–∏–∫—É metadata - –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. **–ù–ï –º–µ–Ω—è—Ç—å** –ª–æ–≥–∏–∫—É fallback - —ç—Ç–æ —Å—Ç—Ä–∞—Ö–æ–≤–∫–∞ –Ω–∞ —Å–ª—É—á–∞–π –ø—Ä–æ–≤–∞–ª–∞
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** —Å —Ä–∞–∑–Ω—ã–º–∏ user_signal –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º–∏
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å** —á—Ç–æ few-shot –ø—Ä–∏–º–µ—Ä—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –Ω–æ–≤—ã–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º

### –ü–æ—Ä—è–¥–æ–∫ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:
1. –°–Ω–∞—á–∞–ª–∞ Step 1-2 (—É—Å–∏–ª–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π)
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
3. –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ - Step 3 (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞)
4. –ï—Å–ª–∏ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–±–ª–µ–º–∞ - Step 4
5. Step 5-6 –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:
- Claude –±—É–¥–µ—Ç –≤—Å—Ç—Ä–∞–∏–≤–∞—Ç—å CTA –æ—Ä–≥–∞–Ω–∏—á–Ω–æ –≤ 70-80% —Å–ª—É—á–∞–µ–≤
- Fallback –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤ –∫—Ä–∞–π–Ω–∏—Ö —Å–ª—É—á–∞—è—Ö
- CTA –±—É–¥—É—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —á–∞—Å—Ç—å—é –æ—Ç–≤–µ—Ç–∞
- –í –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ CTA –±—É–¥—É—Ç –ø–æ–¥–∞–≤–∞—Ç—å—Å—è –∫–∞–∫ —Ä–µ—à–µ–Ω–∏–µ

## üîç –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–ï—Å–ª–∏ –ø–æ—Å–ª–µ –≤—Å–µ—Ö —à–∞–≥–æ–≤ –æ—Ä–≥–∞–Ω–∏—á–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å—ë –µ—â—ë < 50%:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é Claude (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å claude-3.5-haiku –ø–æ—Å–ª–µ–¥–Ω—è—è)
2. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å temperature 0.4-0.5 –¥–ª—è price_sensitive
3. –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ few-shot –ø—Ä–∏–º–µ—Ä–æ–≤ (5-6 –≤–º–µ—Å—Ç–æ 2-3)
4. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ claude-3.5-sonnet –¥–ª—è –ª—É—á—à–µ–≥–æ —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º

---

**–°—Ç–∞—Ç—É—Å:** –ü–ª–∞–Ω –≥–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π  
**–í—Ä–µ–º—è –Ω–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ:** 1-2 —á–∞—Å–∞  
**–†–∏—Å–∫:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π (–≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–∏–º—ã)